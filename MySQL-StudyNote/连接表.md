#### 

## å†…éƒ¨è¿æ¥ - INNER JOIN

å†…éƒ¨è¿æ¥æ˜¯é»˜è®¤çš„è¿æ¥æ–¹å¼ï¼Œæ‰€ä»¥inner join å¯ä»¥ç›´æ¥ç®€å†™æˆjoin

##### æ˜¾å¼è¿æ¥

joinç”¨äºåŠ å…¥å…¶å®ƒè¡¨

```mysql
select order_id,first_name,last_name
from orders
join customers on orders.customer_id=customers.customer_id
```

-- å¤šä¸ªè¡¨ä¸­çš„åŒä¸€ç±» éœ€è¦å¯¹å…¶é™å®š

```mysql
select order_id,first_name,last_name,customers.customer_id -- ä¸ç„¶mysqlä¸çŸ¥é“ä½ è¦ä»ä¿©è¡¨é‡Œçš„å“ªä¸ªè¡¨é‡Œå–idåˆ—
from orders
join customers on orders.customer_id=customers.customer_id
ORDER BY order_id
```

-- å¯ä»¥ç»™è¡¨èµ·åˆ«åè¿›è¡Œä¹¦å†™ä¸Šçš„ç®€åŒ–

```mssql
select order_id,first_name,last_name,c.customer_id
from orders o
join customers c
	on o.customer_id=c.customer_id
ORDER BY order_id
```

-- è·¨æ•°æ®åº“åŠ å…¥ï¼šåªéœ€ä¸ºä¸å±äºå½“å‰æ•°æ®åº“çš„è¡¨æ·»åŠ å‰ç¼€

```mysql
-- åŠ å…¥å…¶å®ƒæ•°æ®åº“çš„è¡¨

	 -- å½“ä½ ä½¿ç”¨ sql_store åº“æ—¶
use sql_store;
select * 
from order_items oi
join sql_inventory.products sp
	 on oi.product_id = sp.product_id
	 
	 -- å½“ä½ ä½¿ç”¨ sql_inventory åº“æ—¶
use sql_inventory;
select * 
from sql_store.order_items oi
join products sp
	 on oi.product_id = sp.product_id
```

-- joinè¡¨è‡ªå·±æœ¬èº«

```mysql
use sql_hr;
select 
	e.employee_id,
    e.first_name,
    m.first_name as manager
from employees e
join employees m
	 on  m.employee_id = e.reports_to 
```

-- å¤šä¸ªæ¡ä»¶

```mysql
select *
from order_items oi
join order_item_notes oin
	on oi.order_id=oin.order_id
    AND oi.product_id=oin.product_id
```

-- è¿æ¥ä¸¤ä¸ªä»¥ä¸Šçš„è¡¨

```mysql
use sql_store;
select 
	o.customer_id,
    o.order_date,
    c.first_name,
    c.last_name,
    os.name AS status
from orders o
join customers c
	on o.customer_id = c.customer_id
join order_statuses os
	on o.status = os.order_status_id
```

##### éšå¼è¿æ¥

```mysql
select *
from orders o,customers c
WHERE o.customer_id=c.customer_id
```

## å¤–éƒ¨è¿æ¥ - OUTER JOIN

-- å†…éƒ¨è¿æ¥å’Œå¤–éƒ¨é“¾æ¥çš„æ•ˆæœå·®åˆ«ï¼š

```mysql
-- ä½¿ç”¨å†…éƒ¨è¿æ¥
from customers c
-- ç»“æœåªè¿”å›æœ‰è®¢å•çš„å®¢æˆ·
join orders o
	on o.customer_id=c.customer_id -- å› ä¸ºå†…éƒ¨è¿æ¥åªè¿”å›'fromåè¡¨'(å°±æ˜¯customersè¡¨)ç¬¦åˆæ¡ä»¶å¥çš„è®°å½•
order by c.customer_id
```

-- ä½¿ç”¨å¤–éƒ¨è¿æ¥ 

ğŸ’ğŸ»â€â™€ï¸fromåè¾¹æ¥å·¦è¡¨ï¼Œonåé¢æ¥å³è¡¨

ä½¿ç”¨å·¦è¿æ¥æ—¶ï¼Œæ‰€æœ‰æ¥è‡ªå·¦è¡¨çš„è®°å½•æ— è®ºæ˜¯å¦æ»¡è¶³onæ¡ä»¶éƒ½ä¼šè¢«æ˜¾ç¤ºã€‚

```mysql
-- LEFT JOIN
select 
	c.customer_id,
    c.first_name,
    o.order_id
from customers c -- è¿™æ˜¯å·¦è¡¨
-- å½“æˆ‘ä»¬ä½¿ç”¨å·¦è¿æ¥æ—¶ï¼Œå·¦è¡¨çš„æ‰€æœ‰è®°å½•è¿”å›æ­¤æ¡ä»¶æ˜¯å¦æˆç«‹
left join orders o -- è¿™æ˜¯å³è¡¨
	on o.customer_id=c.customer_id -- è·å–æ‰€æœ‰å®¢æˆ·ï¼Œå¦‚æœä»–ä»¬æœ‰è®¢å•ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°è®¢å•ï¼Œå¦‚æœæ²¡æœ‰ä¹Ÿæ˜¾ç¤ºä¸ªNULL
order by c.customer_id

```

åŒç†ï¼Œä½¿ç”¨å³è¿æ¥æ—¶ï¼Œæ‰€æœ‰æ¥è‡ªå³è¡¨çš„è®°å½•æ— è®ºæ˜¯å¦æ»¡è¶³onæ¡ä»¶éƒ½ä¼šè¢«æ˜¾ç¤ºã€‚âš ï¸ä½†å®è·µä¸­é¿å…ä½¿ç”¨å³è¿æ¥

```mysql
-- RIGHT JOIN
select 
	c.customer_id,
    c.first_name,
    o.order_id
from customers c
-- å½“æˆ‘ä»¬ä½¿ç”¨å³è¿æ¥æ—¶ï¼Œå³è¡¨çš„æ‰€æœ‰è®°å½•è¿”å›æ­¤æ¡ä»¶æ˜¯å¦æˆç«‹
right join orders o -- è¿™æ˜¯å³è¡¨
	on o.customer_id=c.customer_id -- ordersè¡¨çš„æ‰€æœ‰è®°å½•æ— è®ºæ»¡è¶³ä¸å¦éƒ½è¢«è¿”å›
order by c.customer_id
```

-- å¤šä¸ªè¡¨ä½¿ç”¨å¤–éƒ¨è¿æ¥

```mysql
select 
    c.customer_id,
    c.first_name,
    o.order_id,
    sh.name AS shipper
from customers c  -- å·¦è¡¨
LEFT JOIN orders o 
	on o.customer_id=c.customer_id 
LEFT JOIN shippers sh  -- ä¾ç„¶éµç…§customersè¡¨çš„æ‰€æœ‰è®°å½•
	on o.shipper_id=sh.shipper_id  
order by c.customer_id
```

ç»ƒä¹ 

```mysql
select 
		o.order_id,
    o.order_date,
		c.customer_id,
    c.first_name,
    sh.name AS shipper,
    os.name AS status
from orders o 
LEFT JOIN customers c
	on o.customer_id=c.customer_id 
LEFT JOIN shippers sh
	on o.shipper_id=sh.shipper_id
JOIN  order_statuses os -- è¿™é‡Œä¸ç”¨å†™LEFTæ˜¯å› ä¸ºâ€˜fromåè¡¨â€™(ä¹Ÿå°±æ˜¯ordersè¡¨)ä¸­å…¨éƒ½æœ‰studus
	on o.status=os.order_status_id
```

-- è‡ªæˆ‘è¿æ¥

```mysql
use sql_hr;
select
	e.employee_id,
    e.first_name as eName,
    m.first_name as mName
FROM employees e
JOIN employees m -- è¿™é‡Œåªä¼šè¿”å›æœ‰ç»ç†çš„äººï¼Œè€Œå¿½ç•¥äº†æœ€é«˜é¢†å¯¼äººæ²¡æœ‰ç»ç†
	on e.reports_to = m.employee_id -- ä¸Šå¸id=å‘˜å·¥id
	
ä¿®æ”¹å¦‚ä¸‹ï¼š
use sql_hr;
select
	e.employee_id,
    e.first_name as eName,
    m.first_name as mName
FROM employees e
LEFT JOIN employees m -- ä½¿ç”¨å·¦è¿æ¥
	on e.reports_to = m.employee_id 
```

##### USINGå­—å¥---onçš„ç®€å†™æ³•

```mysql
select 
	o.order_id,
    c.first_name,
    sh.name AS shipper
from orders o 
LEFT JOIN customers c
	-- on o.customer_id=c.customer_id 
    USING (customer_id)
LEFT JOIN shippers sh
	-- on o.shipper_id=sh.shipper_id
    USING (shipper_id)
```

```mysql
select *
from order_items oi
join order_item_notes oin
-- on oi.order_id=oin.order_id
--    AND oi.product_id=oin.product_id
	USING(order_id,product_id)
```

