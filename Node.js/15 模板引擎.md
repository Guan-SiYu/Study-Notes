## Templating Engines æ¨¡æ¿å¼•æ“

è‡³ä»Šä¸ºæ­¢ `response` åé¦ˆçš„å¯¹è±¡éƒ½æ˜¯ `JSON` å¯¹è±¡ï¼Œæœ‰æ—¶ä½ å¯èƒ½éœ€è¦åé¦ˆ HTML åˆ°å®¢æˆ·ç«¯ï¼Œè¿™å°±è¦ç”¨æ¨¡æ¿å¼•æ“äº†ã€‚

Expresså¯ä»¥ä½¿ç”¨çš„æ¨¡æ¿å¼•æ“æœ‰å¾ˆå¤šï¼Œæœ€æœ‰åçš„å°±æ˜¯ `Pug` ã€`Mustache` ã€`EJS` ï¼Œæ¯ä¸ªæ¨¡æ¿å¼•æ“éƒ½æœ‰å„è‡ªçš„è¯­æ³•æ¥åˆ›å»ºåé¦ˆç»™å®¢æˆ·ç«¯çš„åŠ¨æ€HTMLã€‚è¿™èŠ‚è¯¾ä½¿ç”¨ `Pug` æ¥åˆ›å»ºä¸€ä¸ªåŠ¨æ€çš„HTMLåé¦ˆåŒ…ã€‚

```bash
$ npm i pug
```

æˆ‘ä»¬ä½¿ç”¨ `app.set()` æ–¹æ³• è®¾ç½®åº”ç”¨çš„å›¾å½¢å¼•æ“ï¼Œéœ€è®¾ç½®çš„å±æ€§åæ˜¯ `view engine` ï¼Œå±æ€§å€¼æ˜¯ `pug` ã€‚è¿™æ ·è®¾ç½®åï¼ŒExpressä¼šåœ¨å†…éƒ¨è‡ªå·±å¯¼å…¥pugè€Œä¸ç”¨æˆ‘ä»¬requireå¯¼å…¥ã€‚è¿˜æœ‰å¦ä¸€ä¸ªè®¾ç½®ä¸å¿…é¡»ï¼Œæ˜¯å¯é€‰çš„ï¼Œåªæœ‰ä½ éœ€è¦å˜æ›´æ¨¡æ¿è·¯å¾„æ—¶æ‰ä¼šç”¨åˆ°ï¼Œéœ€è¦è®¾ç½®çš„å±æ€§åæ˜¯ `views` ï¼Œå±æ€§å€¼æ˜¯ä½ ä¿å­˜æ¨¡æ¿çš„è·¯å¾„ï¼Œé»˜è®¤çš„è·¯å¾„æ˜¯æ ¹ç›®å½•ä¸‹çš„viewsæ–‡ä»¶å¤¹ `./views` ï¼Œæ„æ€å°±æ˜¯ä½ å¯ä»¥å°†æ‰€æœ‰çš„æ¨¡æ¿éƒ½æ”¾åœ¨viewsç›®å½•ä¸‹ã€‚

```js
app.set('view engine','pug');
app.set('views','./views');
```

ç°åœ¨æˆ‘ä»¬åˆ›å»ºæ–°æ–‡ä»¶å¤¹ğŸ“‚`views` ï¼Œå¹¶åŠ å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œåœ¨`index.pug` ä¸­ç”¨è¿™æ ·çš„è¯­æ³•ç¼–è¾‘æ¨¡æ¿ï¼š

ğŸ˜ˆé€šè¿‡èµ‹å€¼çš„æ–¹å¼åŠ¨æ€è®¾ç½®æ ‡ç­¾çš„å†…å®¹ï¼Œç­‰å·åé¢çš„å˜é‡æ˜¯åœ¨è¿è¡Œæ—¶åŠ¨æ€è®¾ç½®çš„ã€‚

âš ï¸æ³¨æ„ä¸€å®šç´§è·Ÿç­‰å·ä¸èƒ½ç©ºæ ¼

```pug
html
    head
        
        title= Title 
    body
        h1= Header
```

ç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•å°†å˜é‡è½¬æ¢ä¸ºåŠ¨æ€çš„å€¼ï¼Œå›åˆ° `index.js` ï¼Œæˆ‘ä»¬ä½¿ç”¨ `render()` æ–¹æ³•æ›¿æ¢ `send()` ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è§†å›¾çš„åç§°ï¼Œè¿™é‡Œå°±æ˜¯ ''index'' ï¼Œå› ä¸ºæˆ‘ä»¬çš„è§†å›¾æ–‡ä»¶æ˜¯ğŸ“ƒ`index.pug` ï¼›ç¬¬äºŒä¸ªå‚æ•°è¦ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡åŒ…å«æ‰€æœ‰æˆ‘ä»¬åœ¨`index.pug` æ¨¡æ¿ä¸­å®šä¹‰çš„å˜é‡

```js
app.get('/',(req,res)=>{
    res.render('index',{Title:'é¡µé¢æ ‡é¢˜',Header:'è¿™æ˜¯ä¸€ä¸ªh1æ ‡ç­¾'})
})
```

æµè§ˆå™¨è®¿é—® http://localhost:8000/ ä¼šçœ‹åˆ°æ ‡é¢˜



## æ„å»ºç»“æ„æ€§çš„è·¯ç”±

ç°å®å¼€å‘ä¸­ä½ ä¸ä¼šæŠŠæ‰€æœ‰ä»£ç éƒ½æ”¾åœ¨ä¸€ä¸ªindex.jsæ–‡ä»¶ä¸­ï¼Œè¿™èŠ‚è¯¾å­¦ä¹ å¦‚ä½•ç»“æ„åŒ–ä½ çš„åº”ç”¨ã€‚æŠŠå¢åˆ æ”¹æŸ¥é¡¹ç›®ä¸­çš„æ‰€æœ‰æœ‰å…³coursesçš„è·¯ç”±å¤„ç†æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚æŠŠindex.jsæ–‡ä»¶ä¸­ç›¸å…³coursesçš„ä»£ç éƒ½å‰ªåˆ‡åˆ°ğŸ“‚`routes/courses.js` ä¸­ï¼Œä½†æ˜¯ä½ ä¼šå‘ç°ï¼Œå‰ä¸¤è¡Œ

```js
/* routes/courses.js */
const express = require('express');
const app = express();
......
```

è¿™æ ·ç­‰äºä½ å°†è·¯ç”±å¤„ç†ç‹¬ç«‹åœ¨æ–°æ–‡ä»¶ä¸­äº†ï¼Œä½†æ˜¯ä½ åœ¨æ§åˆ¶å°è¿è¡Œæ˜¯nodeçš„index.jsï¼Œæ‰€ä»¥å½“æµè§ˆå™¨å‘é€è¯·æ±‚çš„æ—¶å€™è¿™äº›ç›‘å¬å™¨æ ¹æœ¬æ²¡æ³•å»ç®¡ã€‚é‚£ä¹ˆä½ éœ€è¦å°†è¿™äº›è·¯ç”±module.exportsæš´éœ²ç»™indexã€‚é‚£ä¹ˆæ€ä¹ˆå°†è¿™äº›ç›‘å¬å™¨ç»Ÿä¸€ä¸€ä¸ªæ¥å£å‘¢ï¼Ÿè¿™é‡Œæˆ‘ä»¬å°±éœ€è¦Routeräº†ï¼Œexpressç±»æœ‰ä¸ª `Router()` æ–¹æ³•ï¼Œè°ƒç”¨ä¼šè¿”å›ä¸€ä¸ªRouterå¯¹è±¡ï¼Œæ‰€ä»¥æ›´æ”¹ç¬¬äºŒè¡Œä»£ç ,æœ€ååœ¨æœ«å°¾å¯¼å‡ºï¼š

```js
/* routes/courses.js */
const express = require('express');
//const app = express();
const routes = express.Router();
...... æŒ‰F2å°†æ‰€æœ‰appå­—æ®µæ¢ä¸ºroutes
module.exports = routes;
```

ç°åœ¨å›åˆ°ä¸»æ¨¡å—ç”¨requireåŠ è½½è·¯ç”±æ¨¡å—ï¼Œç„¶åè°ƒç”¨`app.use()`è¿™äº›ç›‘å¬å™¨ä¸­é—´ä»¶å®‰æ’åˆ°è¯·æ±‚å¤„ç†ç®¡é“å½“ä¸­å»ï¼Œè¿™é‡Œéœ€è¦ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è·¯å¾„ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æˆ‘ä»¬çš„è·¯ç”±æ¨¡å—ã€‚è¿™è¡Œä»£ç å°±å‘Šè¯‰äº†Expressï¼Œ**ä»»ä½•ä»¥ `/api/courses` èµ·å§‹çš„è¯·æ±‚è·¯å¾„ï¼Œéƒ½ç”±è¿™ä¸ªcoursesè·¯ç”±æ¨¡å—å¤„ç†ã€‚**

```js
/* index.js */
const cousres = require('./routes/courses');
app.use()
```

ç„¶åæˆ‘ä»¬è¿”å›è·¯ç”±æ¨¡å—æ–‡ä»¶ä¸­ï¼Œæ›´æ”¹æ‰€æœ‰ç›‘å¬å™¨çš„è·¯ç”±å‚æ•°(ç¬¬ä¸€ä¸ªå‚æ•°)ä¸º `'/'` æˆ– `'/:id'` ã€‚
